import datetime

import pandas as pd
from sklearn import linear_model
from sqlalchemy import create_engine, text


def calculate_most_recent_date(engine) -> datetime.date:
    """
    Gather from the database what the most recent date stored is

    :param engine: database engine
    :return: datetime.date
    """
    sql = text(f'''
    select 
    "Date" 
    from s_and_p 
    ORDER BY "Date" 
    DESC LIMIT 1;
    ''')
    return engine.execute(sql).first()[0]


def calculate_greatest_between_years(engine, date: datetime.datetime.date, year_difference: int, day_offset: int):
    """
    Locates the stock with the greatest increase in close over a period

    :param date: date relative to years prior
    :param engine: database engine
    :param year_difference: offset of years from relative date
    :param day_offset: offset of days from relative date
    :return:
    """
    comparative_date = get_comparative_date(date, year_difference, day_offset)

    sql = text(f'''
    select
    a."Name" as "Name",
    a."Close" - b."Close" as "Diff"
    from s_and_p a
    join s_and_p b
    on
        a."Name" = b."Name"
            AND
        a."Date" = '{str(date)}'
            AND
        b."Date" = '{str(comparative_date)}' 
    ORDER BY "Diff" DESC
    LIMIT 1
    ''')
    res = engine.execute(sql).one_or_none()

    # if there is no result, find the nearest previous day with a result
    if res is None:
        return calculate_greatest_between_years(engine, date, year_difference, day_offset + 1)
    return res


def get_comparative_date(date: datetime.date, year_difference: int, day_offset: int) -> datetime.date:
    """
    Calculate the date which has the same values as the desired date
    (Special case this is used for: if the desired date is on a weekend find the date of the previous week day)

    :param date: datetime.date; compared to date
    :param year_difference: Difference of years (5 for 5 years earlier)
    :param day_offset: Offset of days
    :return: datetime.date; Comparative date
    """
    comparative_date = date - datetime.timedelta(days=day_offset)
    return datetime.date(
        int(comparative_date.year) - year_difference,
        int(comparative_date.month),
        int(comparative_date.day)
    )


def calculate_volatility(engine, date: datetime.datetime.date, year_difference: int, day_offset: int) -> pd.DataFrame:
    """
    Calculates the volatility of all of the stocks over a given period
    :param engine: database engine
    :param date: the relative date
    :param year_difference: the difference in years as compared to the relative date
    :param day_offset: the day offset as compared to the relative date
    :return:
    """
    comparative_date = get_comparative_date(date, year_difference, day_offset)

    sql = text(f'''
    select
    "Name",
    "Close"
    from s_and_p 
    WHERE 
    "Date" >= '{comparative_date}'
    ''')
    res = engine.execute(sql).all()

    if not res:
        return calculate_greatest_between_years(engine, date, year_difference, day_offset + 1)

    df = pd.DataFrame(res)
    df.columns = ['Name', 'Close']
    g = df.groupby('Name', as_index=False)
    return g[['Close']].apply(lambda x: x.std() * len(x) ** (1 / 2))


def calculate_max_volatility(engine, date: datetime.datetime.date, year_difference: int, day_offset: int) -> tuple:
    """
    Calculates the maximum volatility amongst the stocks over a period

    :param engine: database engine
    :param date: relative date for period to be determined
    :param year_difference: difference of year in period
    :param day_offset: difference of day in period
    :return: tuple (STOCK, CLOSE)
    """
    vol = calculate_volatility(engine, date, year_difference, day_offset)
    df = vol[vol.Close == vol.Close.max()]
    return tuple([df['Name'].to_list()[0], df['Close'].to_list()])


def calculate_min_volatility(engine, date: datetime.datetime.date, year_difference: int, day_offset: int) -> tuple:
    """
    Calculates the minimum volatility amongst the stocks over a period

    :param engine: database engine
    :param date: relative date for period to be determined
    :param year_difference: difference of year in period
    :param day_offset: difference of day in period
    :return: tuple (STOCK, CLOSE)
    """
    vol = calculate_volatility(engine, date, year_difference, day_offset)
    df = vol[vol.Close == vol.Close.min()]
    return tuple([df['Name'].to_list()[0], df['Close'].to_list()])


def predict_day_year_entry(engine, date: datetime.date) -> None:
    """
    Predict and print the close value for the next year and for the next day for all stocks
    Uses linear model to make predictions.

    :param engine: database engine
    :param date: the date relative to the prediction of next day and next year
    :return: None
    """
    sql = text(f'''
    select
    "Name",
    "Date",
    "Close"
    from s_and_p
    ''')
    res = engine.execute(sql).all()

    # Collect a list of the current S&P Companies from wikipedia
    wiki_s_and_p_table = pd.read_html('https://en.wikipedia.org/wiki/List_of_S%26P_500_companies')

    # Format the data collected to be usable in executor.map
    stock_list = wiki_s_and_p_table[0]['Symbol'].str.replace('.', '-', regex=False).to_list()

    df = pd.DataFrame(res, columns=['name', 'date', 'close'])
    df['date'] = pd.to_numeric(pd.to_datetime(df['date']))
    df = df.dropna()
    for stock in stock_list:
        # gather and split data into x y
        tmp_df = df.loc[df['name'] == stock]
        x = tmp_df.date.values.reshape(-1, 1)
        y = tmp_df.close.values.reshape(-1, 1)

        # fit linear model to data
        regr = linear_model.LinearRegression()
        regr.fit(x, y)

        # Make predictions

        # Format date for next day and apply prediction
        predict_date = get_comparative_date(date, 0, -1)
        p = pd.DataFrame({'date': [predict_date]})
        p['date'] = pd.to_numeric(pd.to_datetime(p['date']))
        day_pred = regr.predict(p.date.values.reshape(-1, 1))

        # Format date for new years day and apply prediction
        predict_date = datetime.date(date.year + 1, 1, 1)
        p = pd.DataFrame({'date': [predict_date]})
        p['date'] = pd.to_numeric(pd.to_datetime(p['date']))
        year_pred = regr.predict(p.date.values.reshape(-1, 1))
        print(stock, " next day prediction: ", day_pred)
        print(stock, " next year prediction: ", year_pred)


if __name__ == '__main__':
    try:
        # GET THE CONNECTION OBJECT (ENGINE) FOR THE DATABASE
        engine = create_engine('postgresql://postgres:postgres@127.0.0.1:5432/historicalstockdb')
    except Exception as ex:
        print("Connection could not be made due to the following error: \n", ex)

    recent_date = calculate_most_recent_date(engine)

    print("Most recent date stored: ", recent_date)
    # Most recent date stored:  2023-01-19

    rose_1 = calculate_greatest_between_years(engine, recent_date, 1, 0)
    rose_5 = calculate_greatest_between_years(engine, recent_date, 5, 0)
    rose_10 = calculate_greatest_between_years(engine, recent_date, 10, 0)

    print("Greatest rise over 1 year period: ", rose_1)
    print("Greatest rise over 5 year period: ", rose_5)
    print("Greatest rise over 10 year period: ", rose_10)
    # Greatest rise over 1 year period:  ('AZO', 381.6500244140625)
    # Greatest rise over 5 year period:  ('AZO', 1533.7400512695312)
    # Greatest rise over 10 year period:  ('NVR', 3958.89990234375)

    greatest_volatility_1 = calculate_max_volatility(engine, recent_date, 1, 0)
    greatest_volatility_5 = calculate_max_volatility(engine, recent_date, 5, 0)
    greatest_volatility_10 = calculate_max_volatility(engine, recent_date, 10, 0)

    print("Greatest volatility over 1 year period: ", greatest_volatility_1)
    print("Greatest volatility over 5 year period: ", greatest_volatility_5)
    print("Greatest volatility over 10 year period: ", greatest_volatility_10)
    # Greatest volatility over 1 year period:  ('NVR', [45512.08602021135])
    # Greatest volatility over 5 year period:  ('NVR', [559345.7578103072])
    # Greatest volatility over 10 year period:  ('NVR', [1731123.8056391745])

    lowest_volatility_1 = calculate_min_volatility(engine, recent_date, 1, 0)
    lowest_volatility_5 = calculate_min_volatility(engine, recent_date, 5, 0)
    lowest_volatility_10 = calculate_min_volatility(engine, recent_date, 10, 0)

    # Likely all results will be GEHC as it only joined the S&P500 in 2022
    print("Least volatility over 1 year period: ", lowest_volatility_1)
    print("Least volatility over 5 year period: ", lowest_volatility_5)
    print("Least volatility over 10 year period: ", lowest_volatility_10)
    # Least volatility over 1 year period:  ('GEHC', [35.333405571810985])
    # Least volatility over 5 year period:  ('GEHC', [35.333405571810985])
    # Least volatility over 10 year period:  ('GEHC', [35.333405571810985])

    predict_day_year_entry(engine, recent_date)
    # MMM  next day prediction:  [[192.19797702]]
    # MMM  next year prediction:  [[197.81628009]]
    # AOS  next day prediction:  [[70.68510758]]
    # AOS  next year prediction:  [[75.38417408]]
    # ABT  next day prediction:  [[116.04700643]]
    # ABT  next year prediction:  [[124.74809945]]
    # ABBV  next day prediction:  [[130.90314364]]
    # ABBV  next year prediction:  [[139.95710528]]
    # ACN  next day prediction:  [[294.68467318]]
    # ACN  next year prediction:  [[318.28304203]]
    # ATVI  next day prediction:  [[89.45142319]]
    # ATVI  next year prediction:  [[96.61503967]]
    # ADM  next day prediction:  [[65.91713255]]
    # ADM  next year prediction:  [[69.15177893]]
    # ADBE  next day prediction:  [[487.4956634]]
    # ADBE  next year prediction:  [[534.2922171]]
    # ADP  next day prediction:  [[217.37154598]]
    # ADP  next year prediction:  [[233.7548896]]
    # AAP  next day prediction:  [[193.42883062]]
    # AAP  next year prediction:  [[202.19965517]]
    # AES  next day prediction:  [[22.08495344]]
    # AES  next year prediction:  [[23.21785845]]
    # AFL  next day prediction:  [[58.73855454]]
    # AFL  next year prediction:  [[61.95984542]]
    # A  next day prediction:  [[130.90365983]]
    # A  next year prediction:  [[141.48923703]]
    # APD  next day prediction:  [[285.21475831]]
    # APD  next year prediction:  [[304.93569679]]
    # AKAM  next day prediction:  [[108.23347251]]
    # AKAM  next year prediction:  [[114.6530326]]
    # ALK  next day prediction:  [[65.40664961]]
    # ALK  next year prediction:  [[67.25370051]]
    # ALB  next day prediction:  [[182.66879975]]
    # ALB  next year prediction:  [[196.37129601]]
    # ARE  next day prediction:  [[185.75334066]]
    # ARE  next year prediction:  [[197.15917004]]
    # ALGN  next day prediction:  [[452.05461393]]
    # ALGN  next year prediction:  [[495.21498094]]
    # ALLE  next day prediction:  [[127.85296316]]
    # ALLE  next year prediction:  [[136.28067573]]
    # LNT  next day prediction:  [[61.14427847]]
    # LNT  next year prediction:  [[64.72576603]]
    # ALL  next day prediction:  [[131.8281989]]
    # ALL  next year prediction:  [[140.18300483]]
    # GOOGL  next day prediction:  [[111.40298841]]
    # GOOGL  next year prediction:  [[120.95712058]]
    # GOOG  next day prediction:  [[111.81427033]]
    # GOOG  next year prediction:  [[121.47149425]]
    # MO  next day prediction:  [[54.46703364]]
    # MO  next year prediction:  [[55.33511829]]
    # AMZN  next day prediction:  [[153.58357165]]
    # AMZN  next year prediction:  [[168.2393773]]
    # AMCR  next day prediction:  [[11.9473796]]
    # AMCR  next year prediction:  [[12.19911604]]
    # AMD  next day prediction:  [[84.68877229]]
    # AMD  next year prediction:  [[93.94642925]]
    # AEE  next day prediction:  [[91.46210529]]
    # AEE  next year prediction:  [[97.17496823]]
    # AAL  next day prediction:  [[25.72472455]]
    # AAL  next year prediction:  [[25.09256618]]
    # AEP  next day prediction:  [[98.39412602]]
    # AEP  next year prediction:  [[103.48532023]]
    # AXP  next day prediction:  [[150.01193863]]
    # AXP  next year prediction:  [[158.78384278]]
    # AIG  next day prediction:  [[54.01555562]]
    # AIG  next year prediction:  [[54.65309988]]
    # AMT  next day prediction:  [[266.09186159]]
    # AMT  next year prediction:  [[285.83289328]]
    # AWK  next day prediction:  [[163.81551115]]
    # AWK  next year prediction:  [[176.53127886]]
    # AMP  next day prediction:  [[248.52028324]]
    # AMP  next year prediction:  [[266.17765628]]
    # ABC  next day prediction:  [[130.55578603]]
    # ABC  next year prediction:  [[137.64456587]]
    # AME  next day prediction:  [[126.34456347]]
    # AME  next year prediction:  [[135.37624156]]
    # AMGN  next day prediction:  [[261.09338484]]
    # AMGN  next year prediction:  [[276.32046573]]
    # APH  next day prediction:  [[72.97519261]]
    # APH  next year prediction:  [[78.55429704]]
    # ADI  next day prediction:  [[159.78521811]]
    # ADI  next year prediction:  [[171.85752337]]
    # ANSS  next day prediction:  [[320.22347479]]
    # ANSS  next year prediction:  [[346.76611291]]
    # AON  next day prediction:  [[273.97489167]]
    # AON  next year prediction:  [[295.69838587]]
    # APA  next day prediction:  [[12.19719322]]
    # APA  next year prediction:  [[5.61617934]]
    # AAPL  next day prediction:  [[132.03937599]]
    # AAPL  next year prediction:  [[144.59083598]]
    # AMAT  next day prediction:  [[106.51769375]]
    # AMAT  next year prediction:  [[116.45610106]]
    # APTV  next day prediction:  [[126.09943783]]
    # APTV  next year prediction:  [[134.63128538]]
    # ACGL  next day prediction:  [[45.89501857]]
    # ACGL  next year prediction:  [[48.84582726]]
    # ANET  next day prediction:  [[110.65622685]]
    # ANET  next year prediction:  [[122.58487415]]
    # AJG  next day prediction:  [[146.2979504]]
    # AJG  next year prediction:  [[158.10777003]]
    # AIZ  next day prediction:  [[158.75110012]]
    # AIZ  next year prediction:  [[169.61423222]]
    # T  next day prediction:  [[21.56084648]]
    # T  next year prediction:  [[20.94358071]]
    # ATO  next day prediction:  [[120.44516736]]
    # ATO  next year prediction:  [[127.94687724]]
    # ADSK  next day prediction:  [[256.30089859]]
    # ADSK  next year prediction:  [[279.02754255]]
    # AZO  next day prediction:  [[1724.80279712]]
    # AZO  next year prediction:  [[1863.482832]]
    # AVB  next day prediction:  [[212.82977474]]
    # AVB  next year prediction:  [[219.61792384]]
    # AVY  next day prediction:  [[185.56698393]]
    # AVY  next year prediction:  [[200.65780752]]
    # BKR  next day prediction:  [[19.03879958]]
    # BKR  next year prediction:  [[15.54061199]]
    # BALL  next day prediction:  [[83.30125616]]
    # BALL  next year prediction:  [[89.3717557]]
    # BAC  next day prediction:  [[39.52977065]]
    # BAC  next year prediction:  [[42.27435027]]
    # BBWI  next day prediction:  [[35.34479596]]
    # BBWI  next year prediction:  [[34.01947461]]
    # BAX  next day prediction:  [[86.45567308]]
    # BAX  next year prediction:  [[91.46795955]]
    # BDX  next day prediction:  [[285.52431996]]
    # BDX  next year prediction:  [[303.53079378]]
    # WRB  next day prediction:  [[58.24402077]]
    # WRB  next year prediction:  [[62.45922602]]
    # BRK-B  next day prediction:  [[289.68811433]]
    # BRK-B  next year prediction:  [[308.44056797]]
    # BBY  next day prediction:  [[104.93307996]]
    # BBY  next year prediction:  [[113.03399858]]
    # BIO  next day prediction:  [[571.25619358]]
    # BIO  next year prediction:  [[620.92782944]]
    # TECH  next day prediction:  [[90.71208297]]
    # TECH  next year prediction:  [[98.61774065]]
    # BIIB  next day prediction:  [[295.57198344]]
    # BIIB  next year prediction:  [[299.76705589]]
    # BLK  next day prediction:  [[744.81314402]]
    # BLK  next year prediction:  [[795.46100776]]
    # BK  next day prediction:  [[53.27169818]]
    # BK  next year prediction:  [[55.26612672]]
    # BA  next day prediction:  [[279.66898377]]
    # BA  next year prediction:  [[294.94259132]]
    # BKNG  next day prediction:  [[2364.84393441]]
    # BKNG  next year prediction:  [[2504.54034792]]
    # BWA  next day prediction:  [[40.04476153]]
    # BWA  next year prediction:  [[39.44985628]]
    # BXP  next day prediction:  [[110.07556893]]
    # BXP  next year prediction:  [[109.12060316]]
    # BSX  next day prediction:  [[48.16107974]]
    # BSX  next year prediction:  [[51.93873585]]
    # BMY  next day prediction:  [[69.63013285]]
    # BMY  next year prediction:  [[71.89965708]]
    # AVGO  next day prediction:  [[510.78291728]]
    # AVGO  next year prediction:  [[558.39804956]]
    # BR  next day prediction:  [[168.32713168]]
    # BR  next year prediction:  [[182.25203116]]
    # BRO  next day prediction:  [[56.16817266]]
    # BRO  next year prediction:  [[60.75986939]]
    # BF-B  next day prediction:  [[75.45347257]]
    # BF-B  next year prediction:  [[80.18507309]]
    # CHRW  next day prediction:  [[100.81340092]]
    # CHRW  next year prediction:  [[104.79696837]]
    # CDNS  next day prediction:  [[139.74806511]]
    # CDNS  next year prediction:  [[153.81413816]]
    # CZR  next day prediction:  [[79.4790201]]
    # CZR  next year prediction:  [[88.53189597]]
    # CPT  next day prediction:  [[131.10476115]]
    # CPT  next year prediction:  [[137.80824355]]
    # CPB  next day prediction:  [[49.25439768]]
    # CPB  next year prediction:  [[49.79290574]]
    # COF  next day prediction:  [[121.0791712]]
    # COF  next year prediction:  [[126.895325]]
    # CAH  next day prediction:  [[75.48000336]]
    # CAH  next year prediction:  [[75.48000336]]
    # KMX  next day prediction:  [[108.93424193]]
    # KMX  next year prediction:  [[115.66596447]]
    # CCL  next day prediction:  [[29.74610816]]
    # CCL  next year prediction:  [[28.01692183]]
    # CARR  next day prediction:  [[50.01802559]]
    # CARR  next year prediction:  [[56.82194926]]
    # CTLT  next day prediction:  [[103.70023536]]
    # CTLT  next year prediction:  [[114.36476875]]
    # CAT  next day prediction:  [[194.74851301]]
    # CAT  next year prediction:  [[206.48301154]]
    # CBOE  next day prediction:  [[131.81994353]]
    # CBOE  next year prediction:  [[140.43438267]]
    # CBRE  next day prediction:  [[79.38291609]]
    # CBRE  next year prediction:  [[85.33299008]]
    # CDW  next day prediction:  [[180.68318]]
    # CDW  next year prediction:  [[198.76462734]]
    # CE  next day prediction:  [[143.40040912]]
    # CE  next year prediction:  [[152.77248464]]
    # CNC  next day prediction:  [[83.32286642]]
    # CNC  next year prediction:  [[90.15041252]]
    # CNP  next day prediction:  [[27.84692722]]
    # CNP  next year prediction:  [[28.43559315]]
    # CDAY  next day prediction:  [[90.29002292]]
    # CDAY  next year prediction:  [[99.48541588]]
    # CF  next day prediction:  [[60.60218521]]
    # CF  next year prediction:  [[62.94979215]]
    # CRL  next day prediction:  [[273.16138199]]
    # CRL  next year prediction:  [[297.64902454]]
    # SCHW  next day prediction:  [[70.83564442]]
    # SCHW  next year prediction:  [[76.00940977]]
    # CHTR  next day prediction:  [[615.57862674]]
    # CHTR  next year prediction:  [[666.65627551]]
    # CVX  next day prediction:  [[122.5789771]]
    # CVX  next year prediction:  [[124.11466924]]
    # CMG  next day prediction:  [[1351.95743472]]
    # CMG  next year prediction:  [[1456.88400621]]
    # CB  next day prediction:  [[187.82363797]]
    # CB  next year prediction:  [[197.63194023]]
    # CHD  next day prediction:  [[92.91710512]]
    # CHD  next year prediction:  [[99.28081923]]
    # CI  next day prediction:  [[264.65937508]]
    # CI  next year prediction:  [[283.48607673]]
    # CINF  next day prediction:  [[115.68502511]]
    # CINF  next year prediction:  [[122.84354537]]
    # CTAS  next day prediction:  [[392.30100098]]
    # CTAS  next year prediction:  [[428.87776783]]
    # CSCO  next day prediction:  [[55.35265889]]
    # CSCO  next year prediction:  [[58.67826636]]
    # C  next day prediction:  [[67.09092922]]
    # C  next year prediction:  [[69.11310358]]
    # CFG  next day prediction:  [[43.59489827]]
    # CFG  next year prediction:  [[45.7106438]]
    # CLX  next day prediction:  [[188.24628545]]
    # CLX  next year prediction:  [[198.09241637]]
    # CME  next day prediction:  [[227.82275043]]
    # CME  next year prediction:  [[243.85512611]]
    # CMS  next day prediction:  [[69.70009407]]
    # CMS  next year prediction:  [[73.91964218]]
    # KO  next day prediction:  [[57.89652525]]
    # KO  next year prediction:  [[59.88249107]]
    # CTSH  next day prediction:  [[80.27097665]]
    # CTSH  next year prediction:  [[83.73373186]]
    # CL  next day prediction:  [[80.67867477]]
    # CL  next year prediction:  [[82.74818979]]
    # CMCSA  next day prediction:  [[51.00200075]]
    # CMCSA  next year prediction:  [[53.81773801]]
    # CMA  next day prediction:  [[82.24779002]]
    # CMA  next year prediction:  [[86.27739734]]
    # CAG  next day prediction:  [[37.44609772]]
    # CAG  next year prediction:  [[38.52631006]]
    # COP  next day prediction:  [[69.89094793]]
    # COP  next year prediction:  [[71.31508772]]
    # ED  next day prediction:  [[90.71338949]]
    # ED  next year prediction:  [[93.72762423]]
    # STZ  next day prediction:  [[264.37341361]]
    # STZ  next year prediction:  [[283.42373833]]
    # CEG  next day prediction:  [[96.4117291]]
    # CEG  next year prediction:  [[146.21051465]]
    # COO  next day prediction:  [[391.78498805]]
    # COO  next year prediction:  [[419.8675949]]
    # CPRT  next day prediction:  [[61.66735385]]
    # CPRT  next year prediction:  [[67.5932136]]
    # GLW  next day prediction:  [[39.16855752]]
    # GLW  next year prediction:  [[41.45614175]]
    # CTVA  next day prediction:  [[62.6445304]]
    # CTVA  next year prediction:  [[73.60369265]]
    # CSGP  next day prediction:  [[81.55465742]]
    # CSGP  next year prediction:  [[88.93305183]]
    # COST  next day prediction:  [[444.71511681]]
    # COST  next year prediction:  [[481.43728223]]
    # CTRA  next day prediction:  [[20.60288331]]
    # CTRA  next year prediction:  [[19.88468633]]
    # CCI  next day prediction:  [[178.25078756]]
    # CCI  next year prediction:  [[189.65537674]]
    # CSX  next day prediction:  [[33.36545619]]
    # CSX  next year prediction:  [[35.99777106]]
    # CMI  next day prediction:  [[222.00665773]]
    # CMI  next year prediction:  [[233.09698786]]
    # CVS  next day prediction:  [[86.89042164]]
    # CVS  next year prediction:  [[88.76806787]]
    # DHI  next day prediction:  [[80.64058433]]
    # DHI  next year prediction:  [[87.0484379]]
    # DHR  next day prediction:  [[253.355246]]
    # DHR  next year prediction:  [[275.80500593]]
    # DRI  next day prediction:  [[139.86886689]]
    # DRI  next year prediction:  [[149.4267241]]
    # DVA  next day prediction:  [[96.6670077]]
    # DVA  next year prediction:  [[100.59298064]]
    # DE  next day prediction:  [[316.59033947]]
    # DE  next year prediction:  [[343.11434975]]
    # DAL  next day prediction:  [[50.73456112]]
    # DAL  next year prediction:  [[52.71840868]]
    # XRAY  next day prediction:  [[51.99265783]]
    # XRAY  next year prediction:  [[52.35249673]]
    # DVN  next day prediction:  [[28.05457495]]
    # DVN  next year prediction:  [[25.35507221]]
    # DXCM  next day prediction:  [[100.37957711]]
    # DXCM  next year prediction:  [[110.73185226]]
    # FANG  next day prediction:  [[114.72669234]]
    # FANG  next year prediction:  [[120.43499361]]
    # DLR  next day prediction:  [[151.19621274]]
    # DLR  next year prediction:  [[159.78287376]]
    # DFS  next day prediction:  [[102.45419238]]
    # DFS  next year prediction:  [[108.27907716]]
    # DISH  next day prediction:  [[30.7327367]]
    # DISH  next year prediction:  [[28.58768492]]
    # DIS  next day prediction:  [[153.37410685]]
    # DIS  next year prediction:  [[161.55623075]]
    # DG  next day prediction:  [[222.17677912]]
    # DG  next year prediction:  [[240.49643228]]
    # DLTR  next day prediction:  [[132.14067523]]
    # DLTR  next year prediction:  [[140.10581461]]
    # D  next day prediction:  [[82.19343265]]
    # D  next year prediction:  [[84.07124659]]
    # DPZ  next day prediction:  [[443.38948961]]
    # DPZ  next year prediction:  [[483.01098599]]
    # DOV  next day prediction:  [[139.89029109]]
    # DOV  next year prediction:  [[149.58787024]]
    # DOW  next day prediction:  [[59.18472811]]
    # DOW  next year prediction:  [[62.24345386]]
    # DTE  next day prediction:  [[125.25184536]]
    # DTE  next year prediction:  [[132.02060208]]
    # DUK  next day prediction:  [[102.15593764]]
    # DUK  next year prediction:  [[105.51879739]]
    # DD  next day prediction:  [[78.17768239]]
    # DD  next year prediction:  [[79.67486204]]
    # DXC  next day prediction:  [[46.06785178]]
    # DXC  next year prediction:  [[47.35389442]]
    # EMN  next day prediction:  [[99.90889184]]
    # EMN  next year prediction:  [[103.09527867]]
    # ETN  next day prediction:  [[134.76464152]]
    # ETN  next year prediction:  [[143.20949449]]
    # EBAY  next day prediction:  [[56.30708534]]
    # EBAY  next year prediction:  [[59.96420333]]
    # ECL  next day prediction:  [[212.00436297]]
    # ECL  next year prediction:  [[224.43621328]]
    # EIX  next day prediction:  [[69.18140964]]
    # EIX  next year prediction:  [[70.55389129]]
    # EW  next day prediction:  [[100.6635715]]
    # EW  next year prediction:  [[109.73111301]]
    # EA  next day prediction:  [[153.36421318]]
    # EA  next year prediction:  [[165.37080276]]
    # ELV  next day prediction:  [[429.29666103]]
    # ELV  next year prediction:  [[465.57332599]]
    # LLY  next day prediction:  [[238.79224266]]
    # LLY  next year prediction:  [[259.53118108]]
    # EMR  next day prediction:  [[85.32423561]]
    # EMR  next year prediction:  [[88.59736265]]
    # ENPH  next day prediction:  [[152.87490005]]
    # ENPH  next year prediction:  [[170.94450947]]
    # ETR  next day prediction:  [[112.50823977]]
    # ETR  next year prediction:  [[117.14488424]]
    # EOG  next day prediction:  [[97.06606057]]
    # EOG  next year prediction:  [[99.06896867]]
    # EPAM  next day prediction:  [[392.90550286]]
    # EPAM  next year prediction:  [[433.01074145]]
    # EQT  next day prediction:  [[19.90242173]]
    # EQT  next year prediction:  [[17.9240583]]
    # EFX  next day prediction:  [[214.86784511]]
    # EFX  next year prediction:  [[230.30101663]]
    # EQIX  next day prediction:  [[765.943502]]
    # EQIX  next year prediction:  [[824.75490589]]
    # EQR  next day prediction:  [[76.15509806]]
    # EQR  next year prediction:  [[77.58640856]]
    # ESS  next day prediction:  [[310.90154916]]
    # ESS  next year prediction:  [[324.49766601]]
    # EL  next day prediction:  [[273.27416899]]
    # EL  next year prediction:  [[295.71618812]]
    # ETSY  next day prediction:  [[165.90437016]]
    # ETSY  next year prediction:  [[188.8120869]]
    # RE  next day prediction:  [[294.06451632]]
    # RE  next year prediction:  [[309.40770615]]
    # EVRG  next day prediction:  [[70.14546858]]
    # EVRG  next year prediction:  [[73.71162702]]
    # ES  next day prediction:  [[92.03949247]]
    # ES  next year prediction:  [[97.10990919]]
    # EXC  next day prediction:  [[37.39182153]]
    # EXC  next year prediction:  [[38.89728263]]
    # EXPE  next day prediction:  [[151.39035324]]
    # EXPE  next year prediction:  [[159.08732352]]
    # EXPD  next day prediction:  [[106.63979295]]
    # EXPD  next year prediction:  [[113.66796463]]
    # EXR  next day prediction:  [[165.35135697]]
    # EXR  next year prediction:  [[177.99006348]]
    # XOM  next day prediction:  [[65.67540482]]
    # XOM  next year prediction:  [[63.30339663]]
    # FFIV  next day prediction:  [[183.51747919]]
    # FFIV  next year prediction:  [[191.68538908]]
    # FDS  next day prediction:  [[391.90636335]]
    # FDS  next year prediction:  [[422.07697605]]
    # FAST  next day prediction:  [[48.80038784]]
    # FAST  next year prediction:  [[51.81186632]]
    # FRT  next day prediction:  [[116.05474953]]
    # FRT  next year prediction:  [[115.40699152]]
    # FDX  next day prediction:  [[246.50009602]]
    # FDX  next year prediction:  [[258.36533889]]
    # FITB  next day prediction:  [[36.82798022]]
    # FITB  next year prediction:  [[38.83210465]]
    # FRC  next day prediction:  [[163.97051232]]
    # FRC  next year prediction:  [[176.4542769]]
    # FSLR  next day prediction:  [[90.30329294]]
    # FSLR  next year prediction:  [[95.72342242]]
    # FE  next day prediction:  [[37.44030036]]
    # FE  next year prediction:  [[37.47101284]]
    # FIS  next day prediction:  [[137.71185824]]
    # FIS  next year prediction:  [[146.57645824]]
    # FISV  next day prediction:  [[120.72654923]]
    # FISV  next year prediction:  [[130.28982362]]
    # FLT  next day prediction:  [[285.07556328]]
    # FLT  next year prediction:  [[303.93396547]]
    # FMC  next day prediction:  [[112.57481545]]
    # FMC  next year prediction:  [[119.48576097]]
    # F  next day prediction:  [[11.22503408]]
    # F  next year prediction:  [[11.0066021]]
    # FTNT  next day prediction:  [[44.70881747]]
    # FTNT  next year prediction:  [[49.29821859]]
    # FTV  next day prediction:  [[70.19565121]]
    # FTV  next year prediction:  [[72.7872894]]
    # FOXA  next day prediction:  [[35.01721654]]
    # FOXA  next year prediction:  [[35.54092342]]
    # FOX  next day prediction:  [[32.07931972]]
    # FOX  next year prediction:  [[31.84850927]]
    # BEN  next day prediction:  [[23.72410776]]
    # BEN  next year prediction:  [[21.33278396]]
    # FCX  next day prediction:  [[21.29246131]]
    # FCX  next year prediction:  [[20.93723238]]
    # GRMN  next day prediction:  [[116.67126732]]
    # GRMN  next year prediction:  [[124.74917485]]
    # IT  next day prediction:  [[250.3537212]]
    # IT  next year prediction:  [[270.9176398]]
    # GEHC  next day prediction:  [[63.51020487]]
    # GEHC  next year prediction:  [[136.07612131]]
    # GEN  next day prediction:  [[24.64046963]]
    # GEN  next year prediction:  [[24.92451953]]
    # GNRC  next day prediction:  [[231.75062671]]
    # GNRC  next year prediction:  [[254.50539738]]
    # GD  next day prediction:  [[228.11127382]]
    # GD  next year prediction:  [[240.75048324]]
    # GE  next day prediction:  [[54.97883359]]
    # GE  next year prediction:  [[44.85685071]]
    # GIS  next day prediction:  [[66.33379474]]
    # GIS  next year prediction:  [[68.2314942]]
    # GM  next day prediction:  [[44.61479588]]
    # GM  next year prediction:  [[46.07573291]]
    # GPC  next day prediction:  [[129.15540505]]
    # GPC  next year prediction:  [[134.6698723]]
    # GILD  next day prediction:  [[75.29374553]]
    # GILD  next year prediction:  [[76.00931053]]
    # GL  next day prediction:  [[109.33207157]]
    # GL  next year prediction:  [[115.77458792]]
    # GPN  next day prediction:  [[182.5093688]]
    # GPN  next year prediction:  [[197.54531188]]
    # GS  next day prediction:  [[324.3932671]]
    # GS  next year prediction:  [[342.81540853]]
    # HAL  next day prediction:  [[23.92071471]]
    # HAL  next year prediction:  [[21.71033912]]
    # HIG  next day prediction:  [[68.30941725]]
    # HIG  next year prediction:  [[72.08281595]]
    # HAS  next day prediction:  [[104.37829055]]
    # HAS  next year prediction:  [[109.22652862]]
    # HCA  next day prediction:  [[209.8000711]]
    # HCA  next year prediction:  [[227.36828187]]
    # PEAK  next day prediction:  [[26.88948668]]
    # PEAK  next year prediction:  [[25.83737251]]
    # HSIC  next day prediction:  [[80.48674504]]
    # HSIC  next year prediction:  [[84.27613307]]
    # HSY  next day prediction:  [[186.20164367]]
    # HSY  next year prediction:  [[197.46003033]]
    # HES  next day prediction:  [[77.98725978]]
    # HES  next year prediction:  [[79.88998015]]
    # HPE  next day prediction:  [[15.14772865]]
    # HPE  next year prediction:  [[15.52766997]]
    # HLT  next day prediction:  [[133.04591216]]
    # HLT  next year prediction:  [[143.71626202]]
    # HOLX  next day prediction:  [[72.70305898]]
    # HOLX  next year prediction:  [[77.83178624]]
    # HD  next day prediction:  [[325.20702674]]
    # HD  next year prediction:  [[351.2981193]]
    # HON  next day prediction:  [[214.37871808]]
    # HON  next year prediction:  [[228.61280064]]
    # HRL  next day prediction:  [[53.156017]]
    # HRL  next year prediction:  [[56.26627468]]
    # HST  next day prediction:  [[16.6654714]]
    # HST  next year prediction:  [[16.4962683]]
    # HWM  next day prediction:  [[32.63327304]]
    # HWM  next year prediction:  [[34.60948498]]
    # HPQ  next day prediction:  [[30.23673115]]
    # HPQ  next year prediction:  [[32.20410456]]
    # HUM  next day prediction:  [[474.18273099]]
    # HUM  next year prediction:  [[512.69487506]]
    # HBAN  next day prediction:  [[15.6033663]]
    # HBAN  next year prediction:  [[16.2920627]]
    # HII  next day prediction:  [[255.65071487]]
    # HII  next year prediction:  [[272.30122167]]
    # IBM  next day prediction:  [[113.83270722]]
    # IBM  next year prediction:  [[107.77424559]]
    # IEX  next day prediction:  [[220.07415655]]
    # IEX  next year prediction:  [[236.94802949]]
    # IDXX  next day prediction:  [[478.82766935]]
    # IDXX  next year prediction:  [[525.08416221]]
    # ITW  next day prediction:  [[225.509817]]
    # ITW  next year prediction:  [[241.17812223]]
    # ILMN  next day prediction:  [[382.19940694]]
    # ILMN  next year prediction:  [[410.06768028]]
    # INCY  next day prediction:  [[98.99517704]]
    # INCY  next year prediction:  [[103.32140903]]
    # IR  next day prediction:  [[53.34469127]]
    # IR  next year prediction:  [[58.65143923]]
    # INTC  next day prediction:  [[55.05449751]]
    # INTC  next year prediction:  [[57.77598698]]
    # ICE  next day prediction:  [[119.30690129]]
    # ICE  next year prediction:  [[128.04909466]]
    # IP  next day prediction:  [[46.85081286]]
    # IP  next year prediction:  [[47.375591]]
    # IPG  next day prediction:  [[30.8155679]]
    # IPG  next year prediction:  [[32.35904023]]
    # IFF  next day prediction:  [[146.95875709]]
    # IFF  next year prediction:  [[152.51876304]]
    # INTU  next day prediction:  [[439.62374393]]
    # INTU  next year prediction:  [[480.12271743]]
    # ISRG  next day prediction:  [[274.79616718]]
    # ISRG  next year prediction:  [[298.74102511]]
    # IVZ  next day prediction:  [[18.2804789]]
    # IVZ  next year prediction:  [[16.82340529]]
    # INVH  next day prediction:  [[38.82251993]]
    # INVH  next year prediction:  [[41.98795228]]
    # IQV  next day prediction:  [[226.95137097]]
    # IQV  next year prediction:  [[247.528294]]
    # IRM  next day prediction:  [[42.3106392]]
    # IRM  next year prediction:  [[43.63155439]]
    # JBHT  next day prediction:  [[167.06940454]]
    # JBHT  next year prediction:  [[177.65132809]]
    # JKHY  next day prediction:  [[193.97049782]]
    # JKHY  next year prediction:  [[208.71543832]]
    # J  next day prediction:  [[119.97291139]]
    # J  next year prediction:  [[128.102455]]
    # JNJ  next day prediction:  [[176.55950832]]
    # JNJ  next year prediction:  [[185.76840321]]
    # JCI  next day prediction:  [[55.88574449]]
    # JCI  next year prediction:  [[58.09530519]]
    # JPM  next day prediction:  [[147.30294171]]
    # JPM  next year prediction:  [[157.16098519]]
    # JNPR  next day prediction:  [[29.63317733]]
    # JNPR  next year prediction:  [[30.40662459]]
    # K  next day prediction:  [[68.64655425]]
    # K  next year prediction:  [[69.28168365]]
    # KDP  next day prediction:  [[40.44256931]]
    # KDP  next year prediction:  [[37.84257275]]
    # KEY  next day prediction:  [[21.05259765]]
    # KEY  next year prediction:  [[22.01230946]]
    # KEYS  next day prediction:  [[167.39646096]]
    # KEYS  next year prediction:  [[186.74124147]]
    # KMB  next day prediction:  [[144.38218101]]
    # KMB  next year prediction:  [[149.06116326]]
    # KIM  next day prediction:  [[18.6932845]]
    # KIM  next year prediction:  [[18.33362304]]
    # KMI  next day prediction:  [[11.47279518]]
    # KMI  next year prediction:  [[9.25150373]]
    # KLAC  next day prediction:  [[300.49224615]]
    # KLAC  next year prediction:  [[328.13731136]]
    # KHC  next day prediction:  [[22.09156232]]
    # KHC  next year prediction:  [[14.07818639]]
    # KR  next day prediction:  [[42.90280904]]
    # KR  next year prediction:  [[45.15971959]]
    # LHX  next day prediction:  [[240.49335902]]
    # LHX  next year prediction:  [[259.44954352]]
    # LH  next day prediction:  [[248.49250725]]
    # LH  next year prediction:  [[264.46011501]]
    # LRCX  next day prediction:  [[487.70695011]]
    # LRCX  next year prediction:  [[535.83645471]]
    # LW  next day prediction:  [[80.80174624]]
    # LW  next year prediction:  [[85.40985497]]
    # LVS  next day prediction:  [[49.78563227]]
    # LVS  next year prediction:  [[48.81234745]]
    # LDOS  next day prediction:  [[105.64127489]]
    # LDOS  next year prediction:  [[112.95991336]]
    # LEN  next day prediction:  [[85.65529349]]
    # LEN  next year prediction:  [[90.90984334]]
    # LNC  next day prediction:  [[63.75872992]]
    # LNC  next year prediction:  [[65.77712639]]
    # LIN  next day prediction:  [[281.11872359]]
    # LIN  next year prediction:  [[299.88420849]]
    # LYV  next day prediction:  [[89.93222277]]
    # LYV  next year prediction:  [[97.78209887]]
    # LKQ  next day prediction:  [[46.15450825]]
    # LKQ  next year prediction:  [[48.45635159]]
    # LMT  next day prediction:  [[454.2359369]]
    # LMT  next year prediction:  [[486.14526752]]
    # L  next day prediction:  [[53.63350045]]
    # L  next year prediction:  [[54.90465229]]
    # LOW  next day prediction:  [[193.13511574]]
    # LOW  next year prediction:  [[209.14502459]]
    # LUMN  next day prediction:  [[5.15921298]]
    # LUMN  next year prediction:  [[2.05422718]]
    # LYB  next day prediction:  [[99.25279263]]
    # LYB  next year prediction:  [[101.80828176]]
    # MTB  next day prediction:  [[170.27117416]]
    # MTB  next year prediction:  [[176.14018151]]
    # MRO  next day prediction:  [[10.45246896]]
    # MRO  next year prediction:  [[8.70461903]]
    # MPC  next day prediction:  [[75.97478934]]
    # MPC  next year prediction:  [[80.04781916]]
    # MKTX  next day prediction:  [[440.96263587]]
    # MKTX  next year prediction:  [[480.72620893]]
    # MAR  next day prediction:  [[162.12510783]]
    # MAR  next year prediction:  [[173.37198505]]
    # MMC  next day prediction:  [[150.13944468]]
    # MMC  next year prediction:  [[161.56983451]]
    # MLM  next day prediction:  [[348.66943846]]
    # MLM  next year prediction:  [[373.71317993]]
    # MAS  next day prediction:  [[60.02206322]]
    # MAS  next year prediction:  [[64.3116181]]
    # MA  next day prediction:  [[369.0641134]]
    # MA  next year prediction:  [[401.7622316]]
    # MTCH  next day prediction:  [[108.41647053]]
    # MTCH  next year prediction:  [[118.67418949]]
    # MKC  next day prediction:  [[95.87504296]]
    # MKC  next year prediction:  [[102.37233568]]
    # MCD  next day prediction:  [[252.40572714]]
    # MCD  next year prediction:  [[268.98490217]]
    # MCK  next day prediction:  [[234.72846123]]
    # MCK  next year prediction:  [[245.44669087]]
    # MDT  next day prediction:  [[117.72131727]]
    # MDT  next year prediction:  [[123.89912296]]
    # MRK  next day prediction:  [[88.51227832]]
    # MRK  next year prediction:  [[92.90763256]]
    # META  next day prediction:  [[275.71041447]]
    # META  next year prediction:  [[298.39653282]]
    # MET  next day prediction:  [[59.65566726]]
    # MET  next year prediction:  [[61.87729832]]
    # MTD  next day prediction:  [[1288.93589931]]
    # MTD  next year prediction:  [[1403.64224061]]
    # MGM  next day prediction:  [[37.76825012]]
    # MGM  next year prediction:  [[39.78871126]]
    # MCHP  next day prediction:  [[71.64316262]]
    # MCHP  next year prediction:  [[77.12591321]]
    # MU  next day prediction:  [[72.24720266]]
    # MU  next year prediction:  [[78.28039705]]
    # MSFT  next day prediction:  [[256.46483308]]
    # MSFT  next year prediction:  [[280.92570377]]
    # MAA  next day prediction:  [[168.24340101]]
    # MAA  next year prediction:  [[178.85395786]]
    # MRNA  next day prediction:  [[244.4843514]]
    # MRNA  next year prediction:  [[301.59325327]]
    # MHK  next day prediction:  [[169.04963879]]
    # MHK  next year prediction:  [[171.47123487]]
    # MOH  next day prediction:  [[265.32207047]]
    # MOH  next year prediction:  [[290.80359763]]
    # TAP  next day prediction:  [[57.84001286]]
    # TAP  next year prediction:  [[56.91892285]]
    # MDLZ  next day prediction:  [[62.59123999]]
    # MDLZ  next year prediction:  [[65.48808897]]
    # MPWR  next day prediction:  [[373.81666552]]
    # MPWR  next year prediction:  [[411.92269689]]
    # MNST  next day prediction:  [[94.48652461]]
    # MNST  next year prediction:  [[101.58140212]]
    # MCO  next day prediction:  [[324.70317929]]
    # MCO  next year prediction:  [[352.38550515]]
    # MS  next day prediction:  [[81.4914221]]
    # MS  next year prediction:  [[87.52059637]]
    # MOS  next day prediction:  [[26.37322079]]
    # MOS  next year prediction:  [[24.59836562]]
    # MSI  next day prediction:  [[220.00533118]]
    # MSI  next year prediction:  [[237.79197482]]
    # MSCI  next day prediction:  [[466.30387284]]
    # MSCI  next year prediction:  [[513.63833438]]
    # NDAQ  next day prediction:  [[56.70356394]]
    # NDAQ  next year prediction:  [[61.53318685]]
    # NTAP  next day prediction:  [[74.34105938]]
    # NTAP  next year prediction:  [[78.48644551]]
    # NFLX  next day prediction:  [[483.69849948]]
    # NFLX  next year prediction:  [[529.12837829]]
    # NWL  next day prediction:  [[22.13599405]]
    # NWL  next year prediction:  [[21.04196916]]
    # NEM  next day prediction:  [[54.51300714]]
    # NEM  next year prediction:  [[56.93537392]]
    # NWSA  next day prediction:  [[17.9528357]]
    # NWSA  next year prediction:  [[18.38668429]]
    # NWS  next day prediction:  [[17.98569836]]
    # NWS  next year prediction:  [[18.41585569]]
    # NEE  next day prediction:  [[81.03673451]]
    # NEE  next year prediction:  [[87.54967398]]
    # NKE  next day prediction:  [[133.48921745]]
    # NKE  next year prediction:  [[143.89408616]]
    # NI  next day prediction:  [[31.13560839]]
    # NI  next year prediction:  [[32.82986127]]
    # NDSN  next day prediction:  [[225.01367768]]
    # NDSN  next year prediction:  [[241.94348752]]
    # NSC  next day prediction:  [[256.7673599]]
    # NSC  next year prediction:  [[275.72359093]]
    # NTRS  next day prediction:  [[113.17942308]]
    # NTRS  next year prediction:  [[118.62820127]]
    # NOC  next day prediction:  [[451.85156675]]
    # NOC  next year prediction:  [[487.12942416]]
    # NCLH  next day prediction:  [[28.35183254]]
    # NCLH  next year prediction:  [[26.3846012]]
    # NRG  next day prediction:  [[39.6168691]]
    # NRG  next year prediction:  [[41.4971514]]
    # NUE  next day prediction:  [[95.25112291]]
    # NUE  next year prediction:  [[100.96678833]]
    # NVDA  next day prediction:  [[164.43331928]]
    # NVDA  next year prediction:  [[182.45244503]]
    # NVR  next day prediction:  [[4883.30939049]]
    # NVR  next year prediction:  [[5286.28889654]]
    # NXPI  next day prediction:  [[182.36565644]]
    # NXPI  next year prediction:  [[196.33759059]]
    # ORLY  next day prediction:  [[624.35384269]]
    # ORLY  next year prediction:  [[676.98348348]]
    # OXY  next day prediction:  [[33.70920146]]
    # OXY  next year prediction:  [[28.52024467]]
    # ODFL  next day prediction:  [[251.52007075]]
    # ODFL  next year prediction:  [[276.21639449]]
    # OMC  next day prediction:  [[77.02369824]]
    # OMC  next year prediction:  [[78.10080177]]
    # ON  next day prediction:  [[45.97795854]]
    # ON  next year prediction:  [[50.22892505]]
    # OKE  next day prediction:  [[60.12186738]]
    # OKE  next year prediction:  [[61.63680303]]
    # ORCL  next day prediction:  [[75.1006995]]
    # ORCL  next year prediction:  [[79.46022143]]
    # OGN  next day prediction:  [[28.66656101]]
    # OGN  next year prediction:  [[25.33356374]]
    # OTIS  next day prediction:  [[83.88183537]]
    # OTIS  next year prediction:  [[91.88836785]]
    # PCAR  next day prediction:  [[90.13095475]]
    # PCAR  next year prediction:  [[94.09888512]]
    # PKG  next day prediction:  [[145.79842086]]
    # PKG  next year prediction:  [[155.28024697]]
    # PARA  next day prediction:  [[37.09906261]]
    # PARA  next year prediction:  [[35.51707045]]
    # PH  next day prediction:  [[277.92990995]]
    # PH  next year prediction:  [[296.99081724]]
    # PAYX  next day prediction:  [[113.02603717]]
    # PAYX  next year prediction:  [[120.91402926]]
    # PAYC  next day prediction:  [[405.34406888]]
    # PAYC  next year prediction:  [[454.73644482]]
    # PYPL  next day prediction:  [[191.65114491]]
    # PYPL  next year prediction:  [[212.5843484]]
    # PNR  next day prediction:  [[54.26650767]]
    # PNR  next year prediction:  [[56.03011704]]
    # PEP  next day prediction:  [[164.78634632]]
    # PEP  next year prediction:  [[173.53848475]]
    # PKI  next day prediction:  [[149.2061198]]
    # PKI  next year prediction:  [[161.33962023]]
    # PFE  next day prediction:  [[46.01627985]]
    # PFE  next year prediction:  [[48.03815434]]
    # PCG  next day prediction:  [[12.14481554]]
    # PCG  next year prediction:  [[8.00182393]]
    # PM  next day prediction:  [[92.0831731]]
    # PM  next year prediction:  [[92.44049468]]
    # PSX  next day prediction:  [[95.38785595]]
    # PSX  next year prediction:  [[98.07548511]]
    # PNW  next day prediction:  [[88.4587439]]
    # PNW  next year prediction:  [[91.30616562]]
    # PXD  next day prediction:  [[179.23510572]]
    # PXD  next year prediction:  [[182.99219434]]
    # PNC  next day prediction:  [[179.54842941]]
    # PNC  next year prediction:  [[190.31601669]]
    # POOL  next day prediction:  [[382.52669314]]
    # POOL  next year prediction:  [[418.999224]]
    # PPG  next day prediction:  [[145.60164122]]
    # PPG  next year prediction:  [[152.1709268]]
    # PPL  next day prediction:  [[30.3148582]]
    # PPL  next year prediction:  [[30.25365579]]
    # PFG  next day prediction:  [[69.13154196]]
    # PFG  next year prediction:  [[72.07653969]]
    # PG  next day prediction:  [[141.74696654]]
    # PG  next year prediction:  [[149.07054871]]
    # PGR  next day prediction:  [[109.57743312]]
    # PGR  next year prediction:  [[118.78021101]]
    # PLD  next day prediction:  [[123.3185498]]
    # PLD  next year prediction:  [[132.66977461]]
    # PRU  next day prediction:  [[103.9763982]]
    # PRU  next year prediction:  [[106.95666807]]
    # PEG  next day prediction:  [[66.05928]]
    # PEG  next year prediction:  [[69.23417618]]
    # PTC  next day prediction:  [[122.45479749]]
    # PTC  next year prediction:  [[132.33239799]]
    # PSA  next day prediction:  [[298.77211776]]
    # PSA  next year prediction:  [[312.62251979]]
    # PHM  next day prediction:  [[47.59542632]]
    # PHM  next year prediction:  [[50.90176406]]
    # QRVO  next day prediction:  [[142.11456434]]
    # QRVO  next year prediction:  [[153.81549447]]
    # PWR  next day prediction:  [[92.12666214]]
    # PWR  next year prediction:  [[99.82247296]]
    # QCOM  next day prediction:  [[122.74508687]]
    # QCOM  next year prediction:  [[129.73178561]]
    # DGX  next day prediction:  [[140.58871685]]
    # DGX  next year prediction:  [[148.82647372]]
    # RL  next day prediction:  [[84.93178257]]
    # RL  next year prediction:  [[78.6076011]]
    # RJF  next day prediction:  [[90.21924218]]
    # RJF  next year prediction:  [[96.68743405]]
    # RTX  next day prediction:  [[89.77902274]]
    # RTX  next year prediction:  [[92.73694978]]
    # O  next day prediction:  [[71.15291364]]
    # O  next year prediction:  [[73.97123047]]
    # REG  next day prediction:  [[65.05955508]]
    # REG  next year prediction:  [[65.94758986]]
    # REGN  next day prediction:  [[619.68466251]]
    # REGN  next year prediction:  [[655.94003876]]
    # RF  next day prediction:  [[21.12948503]]
    # RF  next year prediction:  [[22.42446931]]
    # RSG  next day prediction:  [[123.57595352]]
    # RSG  next year prediction:  [[133.16498591]]
    # RMD  next day prediction:  [[222.71168256]]
    # RMD  next year prediction:  [[242.25924448]]
    # RHI  next day prediction:  [[85.41629686]]
    # RHI  next year prediction:  [[90.42155329]]
    # ROK  next day prediction:  [[269.02858015]]
    # ROK  next year prediction:  [[287.29891724]]
    # ROL  next day prediction:  [[38.02215895]]
    # ROL  next year prediction:  [[41.15073859]]
    # ROP  next day prediction:  [[463.759432]]
    # ROP  next year prediction:  [[499.01011549]]
    # ROST  next day prediction:  [[118.96898945]]
    # ROST  next year prediction:  [[127.30311234]]
    # RCL  next day prediction:  [[97.4676131]]
    # RCL  next year prediction:  [[101.17264449]]
    # SPGI  next day prediction:  [[387.73032878]]
    # SPGI  next year prediction:  [[422.19362225]]
    # CRM  next day prediction:  [[225.12093021]]
    # CRM  next year prediction:  [[243.64405854]]
    # SBAC  next day prediction:  [[327.53271782]]
    # SBAC  next year prediction:  [[354.07239018]]
    # SLB  next day prediction:  [[27.03966411]]
    # SLB  next year prediction:  [[21.14980041]]
    # STX  next day prediction:  [[72.25628076]]
    # STX  next year prediction:  [[75.8395071]]
    # SEE  next day prediction:  [[56.30465226]]
    # SEE  next year prediction:  [[58.94873062]]
    # SRE  next day prediction:  [[151.82424514]]
    # SRE  next year prediction:  [[158.6592917]]
    # NOW  next day prediction:  [[508.47800141]]
    # NOW  next year prediction:  [[561.06036908]]
    # SHW  next day prediction:  [[264.15862914]]
    # SHW  next year prediction:  [[285.89659802]]
    # SBNY  next day prediction:  [[202.41298685]]
    # SBNY  next year prediction:  [[213.62698868]]
    # SPG  next day prediction:  [[124.08463162]]
    # SPG  next year prediction:  [[119.34268305]]
    # SWKS  next day prediction:  [[148.51925661]]
    # SWKS  next year prediction:  [[159.26312469]]
    # SJM  next day prediction:  [[134.06612764]]
    # SJM  next year prediction:  [[137.46742377]]
    # SNA  next day prediction:  [[218.8358655]]
    # SNA  next year prediction:  [[230.46118748]]
    # SEDG  next day prediction:  [[290.6130053]]
    # SEDG  next year prediction:  [[332.32641979]]
    # SO  next day prediction:  [[65.32536702]]
    # SO  next year prediction:  [[67.61010247]]
    # LUV  next day prediction:  [[57.990444]]
    # LUV  next year prediction:  [[61.17617918]]
    # SWK  next day prediction:  [[168.55116003]]
    # SWK  next year prediction:  [[176.63268275]]
    # SBUX  next day prediction:  [[103.64356714]]
    # SBUX  next year prediction:  [[110.6905677]]
    # STT  next day prediction:  [[83.67094555]]
    # STT  next year prediction:  [[85.73379737]]
    # STLD  next day prediction:  [[63.36460345]]
    # STLD  next year prediction:  [[68.3950867]]
    # STE  next day prediction:  [[208.83351504]]
    # STE  next year prediction:  [[226.41477069]]
    # SYK  next day prediction:  [[259.96658599]]
    # SYK  next year prediction:  [[279.4368064]]
    # SIVB  next day prediction:  [[450.52657755]]
    # SIVB  next year prediction:  [[489.76491089]]
    # SYF  next day prediction:  [[37.6510055]]
    # SYF  next year prediction:  [[38.70530739]]
    # SNPS  next day prediction:  [[273.20939094]]
    # SNPS  next year prediction:  [[299.88521082]]
    # SYY  next day prediction:  [[84.92466758]]
    # SYY  next year prediction:  [[90.06927754]]
    # TMUS  next day prediction:  [[132.70559726]]
    # TMUS  next year prediction:  [[144.15889606]]
    # TROW  next day prediction:  [[152.98910247]]
    # TROW  next year prediction:  [[161.85758165]]
    # TTWO  next day prediction:  [[171.89738723]]
    # TTWO  next year prediction:  [[187.63220012]]
    # TPR  next day prediction:  [[27.36048572]]
    # TPR  next year prediction:  [[25.12701978]]
    # TRGP  next day prediction:  [[38.91353222]]
    # TRGP  next year prediction:  [[35.95360883]]
    # TGT  next day prediction:  [[175.50486928]]
    # TGT  next year prediction:  [[188.35153416]]
    # TEL  next day prediction:  [[131.42579608]]
    # TEL  next year prediction:  [[140.08727737]]
    # TDY  next day prediction:  [[418.4497743]]
    # TDY  next year prediction:  [[455.29019173]]
    # TFX  next day prediction:  [[385.57933969]]
    # TFX  next year prediction:  [[415.1315441]]
    # TER  next day prediction:  [[105.22972933]]
    # TER  next year prediction:  [[115.05251568]]
    # TSLA  next day prediction:  [[195.43696399]]
    # TSLA  next year prediction:  [[217.5157967]]
    # TXN  next day prediction:  [[179.69048179]]
    # TXN  next year prediction:  [[194.45548023]]
    # TXT  next day prediction:  [[65.4519341]]
    # TXT  next year prediction:  [[68.7811002]]
    # TMO  next day prediction:  [[519.59312973]]
    # TMO  next year prediction:  [[566.66403924]]
    # TJX  next day prediction:  [[69.96198074]]
    # TJX  next year prediction:  [[74.49755319]]
    # TSCO  next day prediction:  [[177.10596244]]
    # TSCO  next year prediction:  [[190.23634133]]
    # TT  next day prediction:  [[156.61756803]]
    # TT  next year prediction:  [[169.66406071]]
    # TDG  next day prediction:  [[630.39608963]]
    # TDG  next year prediction:  [[680.43965538]]
    # TRV  next day prediction:  [[167.71509864]]
    # TRV  next year prediction:  [[176.17500448]]
    # TRMB  next day prediction:  [[64.40034035]]
    # TRMB  next year prediction:  [[68.56745504]]
    # TFC  next day prediction:  [[55.46393436]]
    # TFC  next year prediction:  [[57.56988756]]
    # TYL  next day prediction:  [[424.2911307]]
    # TYL  next year prediction:  [[460.97549621]]
    # TSN  next day prediction:  [[89.5166537]]
    # TSN  next year prediction:  [[95.10091571]]
    # USB  next day prediction:  [[55.03507432]]
    # USB  next year prediction:  [[56.66438772]]
    # UDR  next day prediction:  [[50.33673949]]
    # UDR  next year prediction:  [[52.66237281]]
    # ULTA  next day prediction:  [[389.22065213]]
    # ULTA  next year prediction:  [[417.4590175]]
    # UNP  next day prediction:  [[226.48006171]]
    # UNP  next year prediction:  [[242.32923866]]
    # UAL  next day prediction:  [[63.93693019]]
    # UAL  next year prediction:  [[65.84957537]]
    # UPS  next day prediction:  [[175.26962561]]
    # UPS  next year prediction:  [[184.74173974]]
    # URI  next day prediction:  [[283.86414195]]
    # URI  next year prediction:  [[308.15375652]]
    # UNH  next day prediction:  [[450.70102561]]
    # UNH  next year prediction:  [[491.10719693]]
    # UHS  next day prediction:  [[147.43218673]]
    # UHS  next year prediction:  [[153.94933723]]
    # VLO  next day prediction:  [[100.83428571]]
    # VLO  next year prediction:  [[106.64250276]]
    # VTR  next day prediction:  [[47.18323286]]
    # VTR  next year prediction:  [[44.55075788]]
    # VRSN  next day prediction:  [[231.15297123]]
    # VRSN  next year prediction:  [[249.93042466]]
    # VRSK  next day prediction:  [[197.29094056]]
    # VRSK  next year prediction:  [[212.19066491]]
    # VZ  next day prediction:  [[55.1517765]]
    # VZ  next year prediction:  [[55.9470252]]
    # VRTX  next day prediction:  [[268.03918424]]
    # VRTX  next year prediction:  [[288.52830887]]
    # VFC  next day prediction:  [[74.61834421]]
    # VFC  next year prediction:  [[76.87886368]]
    # VTRS  next day prediction:  [[15.50935866]]
    # VTRS  next year prediction:  [[12.72462591]]
    # VICI  next day prediction:  [[32.19204889]]
    # VICI  next year prediction:  [[34.86095874]]
    # V  next day prediction:  [[231.50682143]]
    # V  next year prediction:  [[250.85180038]]
    # VMC  next day prediction:  [[181.19857135]]
    # VMC  next year prediction:  [[193.42290642]]
    # WAB  next day prediction:  [[90.64752857]]
    # WAB  next year prediction:  [[93.27002715]]
    # WBA  next day prediction:  [[54.32592016]]
    # WBA  next year prediction:  [[53.37257773]]
    # WMT  next day prediction:  [[139.80034269]]
    # WMT  next year prediction:  [[147.35154065]]
    # WBD  next day prediction:  [[22.52414233]]
    # WBD  next year prediction:  [[21.40035002]]
    # WM  next day prediction:  [[152.37460213]]
    # WM  next year prediction:  [[164.1917692]]
    # WAT  next day prediction:  [[317.82724588]]
    # WAT  next year prediction:  [[340.93751424]]
    # WEC  next day prediction:  [[102.67598511]]
    # WEC  next year prediction:  [[108.89637554]]
    # WFC  next day prediction:  [[46.56601152]]
    # WFC  next year prediction:  [[46.64841739]]
    # WELL  next day prediction:  [[76.98117069]]
    # WELL  next year prediction:  [[78.38304232]]
    # WST  next day prediction:  [[308.21462592]]
    # WST  next year prediction:  [[338.21045379]]
    # WDC  next day prediction:  [[55.03062996]]
    # WDC  next year prediction:  [[53.67997999]]
    # WRK  next day prediction:  [[41.05857295]]
    # WRK  next year prediction:  [[39.91990824]]
    # WY  next day prediction:  [[33.76736898]]
    # WY  next year prediction:  [[34.29016666]]
    # WHR  next day prediction:  [[189.63318594]]
    # WHR  next year prediction:  [[195.62988254]]
    # WMB  next day prediction:  [[23.5625365]]
    # WMB  next year prediction:  [[22.21345495]]
    # WTW  next day prediction:  [[231.27851131]]
    # WTW  next year prediction:  [[244.52211414]]
    # GWW  next day prediction:  [[436.62614709]]
    # GWW  next year prediction:  [[461.04036696]]
    # WYNN  next day prediction:  [[91.16024715]]
    # WYNN  next year prediction:  [[86.21298823]]
    # XEL  next day prediction:  [[73.58491749]]
    # XEL  next year prediction:  [[78.10681347]]
    # XYL  next day prediction:  [[108.09044542]]
    # XYL  next year prediction:  [[116.17233313]]
    # YUM  next day prediction:  [[122.55487269]]
    # YUM  next year prediction:  [[130.09007038]]
    # ZBRA  next day prediction:  [[388.4683453]]
    # ZBRA  next year prediction:  [[425.5120274]]
    # ZBH  next day prediction:  [[143.62962141]]
    # ZBH  next year prediction:  [[149.49573159]]
    # ZION  next day prediction:  [[57.83155765]]
    # ZION  next year prediction:  [[61.10384512]]
    # ZTS  next day prediction:  [[185.20226746]]
    # ZTS  next year prediction:  [[202.72416019]]
